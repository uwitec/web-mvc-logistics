2014-02-18 00:07:34,654 [83] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_receive')
ORDER BY sys.columns.column_id
2014-02-18 00:07:34,667 [83] DEBUG Mms - sp_pkeys 'mms_receive'
2014-02-18 15:51:53,062 [1] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-02-18 15:51:53,095 [1] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-02-18 15:51:53,102 [1] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-02-18 15:51:53,103 [1] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2014-02-18 15:51:53,439 [6] DEBUG Servicesys_parameter - 获取字段
2014-02-18 15:51:53,466 [6] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 15:51:53,610 [6] DEBUG Servicesys_parameter - 获取字段
2014-02-18 15:51:53,611 [6] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME_EN'
2014-02-18 15:51:59,236 [7] DEBUG Servicesys_user - 获取实体对象
2014-02-18 15:51:59,239 [7] DEBUG Sys - select sys_user.* from sys_user where UserCode='lhs' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 15:52:02,444 [10] DEBUG Servicesys_user - 获取实体对象
2014-02-18 15:52:02,444 [10] DEBUG Sys - select sys_user.* from sys_user where UserCode='admin' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 15:52:02,583 [10] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-02-18 15:52:02,691 [10] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','LHS-PC','localhost','福建省厦门市','2014-02-18 15:52:02')
2014-02-18 15:52:02,695 [10] DEBUG Servicemms_project - 获取实体对象
2014-02-18 15:52:02,696 [10] DEBUG Mms - select mms_project.* from mms_project where ProjectCode='201306030001'
2014-02-18 15:52:02,766 [8] DEBUG Servicesys_parameter - 获取字段
2014-02-18 15:52:02,767 [8] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 15:52:03,243 [8] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-02-18 15:52:03,811 [8] DEBUG Servicesys_parameter - 获取字段
2014-02-18 15:52:03,812 [8] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 15:52:05,034 [9] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 15:52:08,544 [6] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-02-18 16:22:29,636 [64] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:29,642 [64] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 16:22:29,642 [64] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:29,643 [64] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME_EN'
2014-02-18 16:22:33,794 [64] DEBUG Servicesys_user - 获取实体对象
2014-02-18 16:22:33,794 [64] DEBUG Sys - select sys_user.* from sys_user where UserCode='lhs' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 16:22:48,889 [60] DEBUG Servicesys_user - 获取实体对象
2014-02-18 16:22:48,889 [60] DEBUG Sys - select sys_user.* from sys_user where UserCode='admin' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 16:22:48,891 [60] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-02-18 16:22:48,895 [60] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','LHS-PC','localhost','福建省厦门市','2014-02-18 16:22:48')
2014-02-18 16:22:48,899 [60] DEBUG Servicemms_project - 获取实体对象
2014-02-18 16:22:48,904 [60] DEBUG Mms - select mms_project.* from mms_project where ProjectCode='201306030001'
2014-02-18 16:22:48,924 [53] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:48,925 [53] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 16:22:48,933 [53] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-02-18 16:22:48,935 [53] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:48,936 [53] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 16:22:49,253 [32] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 16:22:54,265 [39] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:54,265 [39] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 16:22:54,266 [39] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:22:54,266 [39] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME_EN'
2014-02-18 16:39:33,963 [45] DEBUG Servicesys_user - 获取实体对象
2014-02-18 16:39:33,969 [45] DEBUG Sys - select sys_user.* from sys_user where UserCode='lhs' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 16:39:38,787 [45] DEBUG Servicesys_user - 获取实体对象
2014-02-18 16:39:38,787 [45] DEBUG Sys - select sys_user.* from sys_user where UserCode='admin' and Password='81dc9bdb52d04dc20036dbd8313ed055' and IsEnable='1'
2014-02-18 16:39:38,789 [45] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'admin' 
2014-02-18 16:39:38,794 [45] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('admin','管理员','LHS-PC','localhost','福建省厦门市','2014-02-18 16:39:38')
2014-02-18 16:39:38,795 [45] DEBUG Servicemms_project - 获取实体对象
2014-02-18 16:39:38,801 [45] DEBUG Mms - select mms_project.* from mms_project where ProjectCode='201306030001'
2014-02-18 16:39:38,821 [48] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:39:38,822 [48] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 16:39:38,841 [48] DEBUG Sys - select * from sys_userSetting where UserCode='admin'
2014-02-18 16:39:38,844 [48] DEBUG Servicesys_parameter - 获取字段
2014-02-18 16:39:38,844 [48] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 16:39:39,016 [39] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'admin' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'admin'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 16:41:43,776 [50] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-02-18 16:41:44,519 [32] DEBUG Servicesys_menu - 获取动态列表
2014-02-18 16:41:44,521 [32] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-02-18 16:41:52,043 [60] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/organize/Index','/Sys/organize')
2014-02-18 16:41:52,055 [60] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 16:41:52,061 [60] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 16:41:56,765 [50] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0402'
2014-02-18 16:41:58,320 [50] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_organizeRoleMap B on B.RoleCode = A.RoleCode and B.OrganizeCode = '0402'
2014-02-18 16:42:14,283 [50] DEBUG Servicesys_organize - 编辑记录
2014-02-18 16:42:14,353 [50] DEBUG Sys - select sys_organize.* from sys_organize where OrganizeCode='0406010101'
2014-02-18 16:42:14,375 [50] DEBUG Sys - insert into sys_organize([ParentCode],[OrganizeCode],[OrganizeName],[Description],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('04060101','0406010101','aaa','bbb','管理员','2014-02-18 16:42:14','管理员','2014-02-18 16:42:14')
2014-02-18 16:42:14,385 [50] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 16:42:14,386 [50] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 16:42:32,535 [57] DEBUG Sys - select sys_organize.* from sys_organize where ParentCode='0406010101'
2014-02-18 16:42:32,537 [57] DEBUG Sys - 
-- 删除机构角色Map
delete from sys_organizeRoleMap where OrganizeCode = '0406010101';

-- 删除用户机构Map
delete from sys_userOrganizeMap where OrganizeCode = '0406010101'
2014-02-18 16:42:32,573 [57] DEBUG Sys - delete from sys_organize where [OrganizeCode] = '0406010101'
2014-02-18 16:42:32,588 [57] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 16:42:32,589 [57] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 16:47:48,270 [47] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/permission/Index','/Sys/permission')
2014-02-18 16:47:48,776 [57] DEBUG Servicesys_permission - 获取动态列表
2014-02-18 16:47:48,777 [57] DEBUG Sys - select A.*,B.PermissionName as ParentName from sys_permission A left join sys_permission B on B.PermissionCode = A.ParentCode
2014-02-18 16:48:12,093 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-02-18 16:48:12,098 [57] DEBUG Servicesys_user - 获取动态列表
2014-02-18 16:48:12,099 [57] DEBUG Sys - select UserCode,UserName from sys_user
2014-02-18 16:48:12,100 [57] DEBUG Servicesys_organize - 获取动态列表
2014-02-18 16:48:12,100 [57] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-02-18 16:48:12,514 [34] DEBUG Servicesys_role - 获取实体列表
2014-02-18 16:48:12,515 [34] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-02-18 16:48:18,863 [57] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-02-18 16:48:18,883 [57] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' ,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-02-18 16:48:18,914 [37] DEBUG Servicesys_permission - 获取动态列表
2014-02-18 16:48:18,918 [37] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-02-18 16:48:18,981 [57] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-02-18 16:49:07,266 [52] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-02-18 16:49:07,279 [52] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 16:49:07,285 [52] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 16:49:07,286 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:49:07,287 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='Pricing'
2014-02-18 16:49:07,287 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:49:07,288 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='MaterialUse'
2014-02-18 16:49:08,785 [52] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-02-18 16:49:08,788 [52] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2014-02-18 16:49:08,791 [52] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-02-18 16:49:08,791 [52] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2014-02-18 16:49:09,556 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:49:09,557 [55] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 16:49:09,642 [55] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:49:20,726 [60] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-02-18 16:49:20,745 [60] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' ,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-02-18 16:49:20,781 [55] DEBUG Servicesys_permission - 获取动态列表
2014-02-18 16:49:20,781 [55] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-02-18 16:49:20,782 [60] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-02-18 16:49:43,905 [37] DEBUG Servicesys_role - 修改角色菜单权限
2014-02-18 16:49:43,907 [37] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2014-02-18 16:49:43,909 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2014-02-18 16:49:43,909 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2014-02-18 16:49:43,910 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2014-02-18 16:49:43,911 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2014-02-18 16:49:43,911 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2014-02-18 16:49:43,912 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2014-02-18 16:49:43,913 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2014-02-18 16:49:43,913 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2014-02-18 16:49:43,914 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2014-02-18 16:49:43,914 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2014-02-18 16:49:43,915 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2014-02-18 16:49:43,916 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2014-02-18 16:49:43,916 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2014-02-18 16:49:43,917 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2014-02-18 16:49:43,917 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2014-02-18 16:49:43,918 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2014-02-18 16:49:43,919 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2014-02-18 16:49:43,919 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2014-02-18 16:49:43,920 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2014-02-18 16:49:43,920 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2014-02-18 16:49:43,921 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2014-02-18 16:49:43,922 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2014-02-18 16:49:43,922 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2014-02-18 16:49:43,923 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2014-02-18 16:49:43,923 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2014-02-18 16:49:43,924 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2014-02-18 16:49:43,925 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2014-02-18 16:49:43,925 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2014-02-18 16:49:43,926 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2014-02-18 16:49:43,926 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2014-02-18 16:49:43,927 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2014-02-18 16:49:43,928 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2014-02-18 16:49:43,928 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2014-02-18 16:49:43,929 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2014-02-18 16:49:43,929 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2014-02-18 16:49:43,930 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2014-02-18 16:49:43,931 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2014-02-18 16:49:43,931 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2014-02-18 16:49:43,932 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2014-02-18 16:49:43,932 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2014-02-18 16:49:43,933 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2014-02-18 16:49:43,934 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2014-02-18 16:49:43,934 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2014-02-18 16:49:43,935 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2014-02-18 16:49:43,935 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2014-02-18 16:49:43,936 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2014-02-18 16:49:43,937 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2014-02-18 16:49:43,937 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2014-02-18 16:49:43,938 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2014-02-18 16:49:43,939 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2014-02-18 16:49:43,939 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2014-02-18 16:49:43,940 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2014-02-18 16:49:43,940 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2014-02-18 16:49:43,941 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2014-02-18 16:49:43,941 [37] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2014-02-18 16:49:43,982 [37] DEBUG Servicesys_role - 修改角色菜单按钮权限
2014-02-18 16:49:43,983 [37] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2014-02-18 16:49:43,984 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','refresh')
2014-02-18 16:49:43,984 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','add')
2014-02-18 16:49:43,985 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','edit')
2014-02-18 16:49:43,985 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','delete')
2014-02-18 16:49:43,986 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','audit')
2014-02-18 16:49:43,987 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1002','download')
2014-02-18 16:49:43,987 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','refresh')
2014-02-18 16:49:43,988 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2014-02-18 16:49:43,989 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2014-02-18 16:49:43,989 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2014-02-18 16:49:43,990 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','audit')
2014-02-18 16:49:43,991 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','download')
2014-02-18 16:49:43,991 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','refresh')
2014-02-18 16:49:43,992 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','add')
2014-02-18 16:49:43,993 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','edit')
2014-02-18 16:49:43,993 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','delete')
2014-02-18 16:49:43,994 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','audit')
2014-02-18 16:49:43,994 [37] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','9960','download')
2014-02-18 16:49:44,036 [37] DEBUG Servicesys_role - 修改角色数据权限
2014-02-18 16:49:44,038 [37] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2014-02-18 16:49:44,038 [37] DEBUG Sys - insert into sys_rolePermissionMap([RoleCode],[PermissionCode],[IsDefault]) values('super','0102','0')
2014-02-18 16:49:44,083 [37] DEBUG Servicesys_role - 修改角色数据列权限
2014-02-18 16:49:44,087 [37] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2014-02-18 16:49:44,089 [37] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','DoPerson')
2014-02-18 16:49:48,135 [47] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/Index','/Mms/send')
2014-02-18 16:49:48,137 [47] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 16:49:48,138 [47] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 16:49:48,138 [47] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:49:48,138 [47] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='Pricing'
2014-02-18 16:49:48,139 [47] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:49:48,139 [47] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='MaterialUse'
2014-02-18 16:49:48,147 [47] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-02-18 16:49:48,148 [47] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
2014-02-18 16:49:48,150 [47] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2014-02-18 16:49:48,151 [47] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'admin'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'admin'
)
order by ButtonSeq
2014-02-18 16:49:48,852 [37] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:49:48,852 [37] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 16:49:48,854 [37] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:50:20,424 [34] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Sys/generator/Index','/Sys/generator')
2014-02-18 16:50:28,071 [47] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('undefined')
ORDER BY sys.columns.column_id
2014-02-18 16:50:28,083 [52] DEBUG Mms - SELECT Name as TableName FROM sys.tables order by Name
2014-02-18 16:50:29,265 [46] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:51:22,140 [47] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:51:22,141 [47] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by  D.WarehouseName asc
2014-02-18 16:51:22,153 [47] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:51:22,803 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:51:22,804 [54] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by  D.WarehouseName desc
2014-02-18 16:51:22,815 [54] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:51:23,426 [57] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:51:23,427 [57] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by  D.WarehouseName asc
2014-02-18 16:51:23,430 [57] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:51:24,025 [52] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:51:24,026 [52] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' order by  D.WarehouseName desc
2014-02-18 16:51:24,030 [52] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName from mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 16:52:34,918 [51] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'admin'
and C.URL in ('/Mms/send/edit')
2014-02-18 16:52:34,935 [51] DEBUG Servicemms_send - 获取实体对象
2014-02-18 16:52:34,936 [51] DEBUG Mms - select mms_send.* from mms_send where BillNo='201306270002'
2014-02-18 16:52:34,943 [51] DEBUG Servicemms_send - 获取上一条下一条数据
2014-02-18 16:52:34,961 [51] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:34,962 [51] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo
2014-02-18 16:52:34,965 [51] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:34,965 [51] DEBUG Mms - select top 1 BillNo from mms_send where BillNo<'201306270002' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 16:52:34,969 [51] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:34,969 [51] DEBUG Mms - select top 1 BillNo from mms_send where BillNo>'201306270002' and ProjectCode='201306030001' order by BillNo
2014-02-18 16:52:34,972 [51] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:34,972 [51] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo desc
2014-02-18 16:52:35,231 [51] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:52:35,232 [51] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='Pricing'
2014-02-18 16:52:35,232 [51] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:52:35,233 [51] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='MaterialUse'
2014-02-18 16:52:35,234 [51] DEBUG Servicesys_code - 获取动态列表
2014-02-18 16:52:35,234 [51] DEBUG Sys - select Text as value,Text as text from sys_code where CodeType='MeasureUnit'
2014-02-18 16:52:35,235 [51] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 16:52:35,235 [51] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 16:52:35,237 [51] DEBUG Servicesys_code - 获取字段
2014-02-18 16:52:35,237 [51] DEBUG Sys - select top 1 Code from sys_code where CodeType='Pricing' and IsEnable='1' and IsDefault='1'
2014-02-18 16:52:36,551 [34] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 16:52:36,552 [34] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'FB00502%' order by MerchantsCode
2014-02-18 16:52:36,655 [55] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 16:52:36,655 [55] DEBUG Mms - select BuildPartCode as value,BuildPartName as text,ParentCode as pid from mms_buildPart where ProjectCode='' order by BuildPartCode
2014-02-18 16:52:37,123 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:52:37,124 [54] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_sendDetail A left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201306270002' order by A.MaterialCode
2014-02-18 16:52:39,131 [54] DEBUG Servicemms_send - 获取实体对象
2014-02-18 16:52:39,131 [54] DEBUG Mms - select mms_send.* from mms_send where BillNo='201307040001'
2014-02-18 16:52:39,133 [54] DEBUG Servicemms_send - 获取上一条下一条数据
2014-02-18 16:52:39,133 [54] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:39,133 [54] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo
2014-02-18 16:52:39,133 [54] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:39,134 [54] DEBUG Mms - select top 1 BillNo from mms_send where BillNo<'201307040001' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 16:52:39,135 [54] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:39,135 [54] DEBUG Mms - select top 1 BillNo from mms_send where BillNo>'201307040001' and ProjectCode='201306030001' order by BillNo
2014-02-18 16:52:39,137 [54] DEBUG Servicemms_send - 获取字段
2014-02-18 16:52:39,137 [54] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo desc
2014-02-18 16:52:39,220 [32] DEBUG Servicemms_send - 获取动态列表
2014-02-18 16:52:39,221 [32] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_sendDetail A left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307040001' order by A.MaterialCode
2014-02-18 16:52:39,290 [55] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 16:52:39,290 [55] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'FB00504%' order by MerchantsCode
2014-02-18 16:53:10,123 [51] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:53:12,267 [51] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_checkDetail')
ORDER BY sys.columns.column_id
2014-02-18 16:53:12,761 [52] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:53:33,505 [52] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:53:48,359 [52] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_dealDetail')
ORDER BY sys.columns.column_id
2014-02-18 16:54:12,362 [52] DEBUG Servicemms_send - 编辑记录
2014-02-18 16:54:12,363 [52] DEBUG Mms - select mms_send.* from mms_send where BillNo='201307040001'
2014-02-18 16:54:12,382 [52] DEBUG Mms - update mms_send set [WarehouseCode] = '201306030002', [ProjectCode] = '201306030001', [UpdatePerson] = '管理员', [UpdateDate] = '2014-02-18 16:54:12' where [BillNo] = '201307040001'
2014-02-18 16:54:16,481 [32] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:54:43,504 [47] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:54:44,149 [34] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:54:47,567 [37] DEBUG Mms - 
SELECT	sys.columns.name						AS ColumnName, 
		type_name(sys.columns.system_type_id)	AS SqlTypeName,
		sys.columns.max_length					AS MaxLength,
		sys.columns.is_nullable					AS IsNullable,
		sys.columns.is_identity					AS IsIdentity,
		(case when exists(select 1  
						 from   syscolumns 
						 join   sysindexkeys on syscolumns.id  =sysindexkeys.id and syscolumns.colid=sysindexkeys.colid and syscolumns.id=sys.columns.object_id 
						 join   sysindexes   on syscolumns.id  =sysindexes.id   and sysindexkeys.indid=sysindexes.indid   
						 join   sysobjects   on sysindexes.name=sysobjects.name and sysobjects.xtype= 'PK '
						 where syscolumns.name = sys.columns.name) then 1 else 0 end) AS IsPrimaryKey,
		(select value from sys.extended_properties where sys.extended_properties.major_id = sys.columns.object_id and sys.extended_properties.minor_id = sys.columns.column_id) as Description
FROM sys.columns    
WHERE sys.columns.object_id = object_id('mms_deal')
ORDER BY sys.columns.column_id
2014-02-18 16:54:47,575 [37] DEBUG Mms - sp_pkeys 'mms_deal'
2014-02-18 16:57:00,113 [47] DEBUG Servicemms_send - 编辑记录
2014-02-18 16:57:00,114 [47] DEBUG Mms - select mms_send.* from mms_send where BillNo='201307040001'
2014-02-18 16:57:00,115 [47] DEBUG Mms - update mms_send set [Purpose] = '002', [ProjectCode] = '201306030001', [UpdatePerson] = '管理员', [UpdateDate] = '2014-02-18 16:57:00' where [BillNo] = '201307040001'
2014-02-18 17:02:55,935 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:02:55,941 [54] DEBUG Mms - select top 20 * from test_user order by UserCode
2014-02-18 17:02:55,954 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:02,824 [46] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:02,825 [46] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 21 and 40
2014-02-18 17:03:02,976 [46] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:12,983 [47] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:12,983 [47] DEBUG Mms - select top 20 * from test_user order by UserCode
2014-02-18 17:03:12,984 [47] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:18,652 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:18,653 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 21 and 40
2014-02-18 17:03:18,654 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:19,551 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:19,552 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 41 and 60
2014-02-18 17:03:19,556 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:20,084 [50] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:20,085 [50] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 61 and 80
2014-02-18 17:03:20,089 [50] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:20,796 [46] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:20,796 [46] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 81 and 100
2014-02-18 17:03:20,801 [46] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:22,454 [57] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:22,455 [57] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 101 and 120
2014-02-18 17:03:22,459 [57] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:34,199 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:34,200 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10581 and 10600
2014-02-18 17:03:34,210 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:34,322 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:34,322 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10601 and 10620
2014-02-18 17:03:34,335 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:40,371 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:40,371 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10561 and 10580
2014-02-18 17:03:40,380 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:40,733 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:40,734 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10541 and 10560
2014-02-18 17:03:40,746 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:41,096 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:41,097 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10521 and 10540
2014-02-18 17:03:41,105 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:41,953 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:41,953 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10501 and 10520
2014-02-18 17:03:41,966 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:42,236 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:42,236 [55] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 10481 and 10500
2014-02-18 17:03:42,245 [55] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:43,666 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:43,666 [55] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 9441 and 9460
2014-02-18 17:03:43,674 [55] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:43,966 [57] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:43,967 [57] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 8881 and 8900
2014-02-18 17:03:43,975 [57] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:44,588 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:44,588 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6161 and 6180
2014-02-18 17:03:44,595 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:44,711 [47] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:44,712 [47] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6181 and 6200
2014-02-18 17:03:44,719 [47] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:45,666 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:45,667 [55] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6141 and 6160
2014-02-18 17:03:45,673 [55] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:48,069 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:48,069 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6121 and 6140
2014-02-18 17:03:48,076 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:48,608 [47] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:48,608 [47] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6101 and 6120
2014-02-18 17:03:48,615 [47] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:49,281 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:49,281 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 6081 and 6100
2014-02-18 17:03:49,288 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:52,316 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:52,316 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 4641 and 4660
2014-02-18 17:03:52,323 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:53,188 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:53,188 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 4621 and 4640
2014-02-18 17:03:53,195 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:53,483 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:53,483 [55] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 4601 and 4620
2014-02-18 17:03:53,490 [55] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:53,737 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:53,737 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 4581 and 4600
2014-02-18 17:03:53,744 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:54,774 [59] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:54,775 [59] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 3041 and 3060
2014-02-18 17:03:54,780 [59] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:54,899 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:54,899 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 2981 and 3000
2014-02-18 17:03:54,904 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:55,030 [55] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:55,031 [55] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 3001 and 3020
2014-02-18 17:03:55,036 [55] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:55,677 [54] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:55,677 [54] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 2961 and 2980
2014-02-18 17:03:55,683 [54] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:57,136 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:57,136 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 2941 and 2960
2014-02-18 17:03:57,142 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:03:57,908 [57] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:03:57,909 [57] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 2921 and 2940
2014-02-18 17:03:57,914 [57] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:04:00,682 [57] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:04:00,683 [57] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 1721 and 1740
2014-02-18 17:04:00,688 [57] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:04:00,794 [53] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:04:00,794 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 1741 and 1760
2014-02-18 17:04:00,802 [53] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:04:02,377 [46] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:04:02,378 [46] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent *, row_number() over (order by UserCode) as FLUENTDATA_ROWNUMBER
									 from test_user
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 1701 and 1720
2014-02-18 17:04:02,383 [46] DEBUG Mms - select count(*) from ( select * from test_user ) tb_temp
2014-02-18 17:04:09,262 [52] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/send/edit')
2014-02-18 17:04:09,270 [52] DEBUG Servicemms_send - 获取实体对象
2014-02-18 17:04:09,270 [52] DEBUG Mms - select mms_send.* from mms_send where BillNo='201307240006'
2014-02-18 17:04:09,271 [52] DEBUG Servicemms_send - 获取上一条下一条数据
2014-02-18 17:04:09,271 [52] DEBUG Servicemms_send - 获取字段
2014-02-18 17:04:09,272 [52] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo
2014-02-18 17:04:09,272 [52] DEBUG Servicemms_send - 获取字段
2014-02-18 17:04:09,272 [52] DEBUG Mms - select top 1 BillNo from mms_send where BillNo<'201307240006' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:04:09,274 [52] DEBUG Servicemms_send - 获取字段
2014-02-18 17:04:09,275 [52] DEBUG Mms - select top 1 BillNo from mms_send where BillNo>'201307240006' and ProjectCode='201306030001' order by BillNo
2014-02-18 17:04:09,278 [52] DEBUG Servicemms_send - 获取字段
2014-02-18 17:04:09,278 [52] DEBUG Mms - select top 1 BillNo from mms_send where ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:04:09,279 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:09,279 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='Pricing'
2014-02-18 17:04:09,280 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:09,280 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='MaterialUse'
2014-02-18 17:04:09,281 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:09,281 [52] DEBUG Sys - select Text as value,Text as text from sys_code where CodeType='MeasureUnit'
2014-02-18 17:04:09,282 [52] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:04:09,282 [52] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:04:09,283 [52] DEBUG Servicesys_code - 获取字段
2014-02-18 17:04:09,283 [52] DEBUG Sys - select top 1 Code from sys_code where CodeType='Pricing' and IsEnable='1' and IsDefault='1'
2014-02-18 17:04:10,020 [50] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:04:10,020 [50] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'FB00503%' order by MerchantsCode
2014-02-18 17:04:10,436 [48] DEBUG Servicemms_send - 获取动态列表
2014-02-18 17:04:10,437 [48] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_sendDetail A left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307240006' order by A.MaterialCode
2014-02-18 17:04:13,748 [48] DEBUG Servicemms_materialType - 获取动态列表
2014-02-18 17:04:13,749 [48] DEBUG Mms - select MaterialTypeName as text,MaterialType as id,ParentCode as pid from mms_materialType order by MaterialType
2014-02-18 17:04:13,827 [59] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:04:13,828 [59] DEBUG Mms - select top 10 * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where WarehouseCode='201306030001' order by MaterialCode
2014-02-18 17:04:13,952 [59] DEBUG Mms - select count(*) from ( select * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where WarehouseCode='201306030001' ) tb_temp
2014-02-18 17:04:16,216 [48] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:04:16,217 [48] DEBUG Mms - select top 10 * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where MaterialType like '0001%'     and WarehouseCode='201306030001' order by MaterialCode
2014-02-18 17:04:16,258 [48] DEBUG Mms - select count(*) from ( select * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where MaterialType like '0001%'     and WarehouseCode='201306030001' ) tb_temp
2014-02-18 17:04:16,722 [49] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:04:16,723 [49] DEBUG Mms - select top 10 * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where MaterialType like '0101%'     and WarehouseCode='201306030001' order by MaterialCode
2014-02-18 17:04:16,767 [49] DEBUG Mms - select count(*) from ( select * from (select 'receive' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.ReceiveDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_receiveDetail as A
    left join mms_receive as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'refund' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.RefundDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_refundDetail as A
    left join mms_refund as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0

    union

    select 'adjust' as SrcBillType
    ,A.BillNo as SrcBillNo
    ,A.RowId as SrcRowId
    ,B.EffectDate as SrcDate
    ,B.WarehouseCode
    ,B.ProjectCode
    ,A.RemainNum
    ,A.UnitPrice as SrcUnitPrice
    ,C.*
    from mms_stockAdjustDetail as A
    left join mms_stockAdjust as B ON A.BillNo=B.BillNo
    left join mms_material as C ON A.MaterialCode=C.MaterialCode
    where A.RemainNum>0) T where MaterialType like '0101%'     and WarehouseCode='201306030001' ) tb_temp
2014-02-18 17:04:24,041 [48] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:04:24,051 [48] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:04:24,051 [48] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:04:24,052 [48] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:24,052 [48] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:04:24,856 [59] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:04:24,856 [59] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:04:24,903 [59] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:04:33,993 [52] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/edit')
2014-02-18 17:04:34,006 [52] DEBUG Servicemms_receive - 获取实体对象
2014-02-18 17:04:34,007 [52] DEBUG Mms - select mms_receive.* from mms_receive where BillNo='201307020016'
2014-02-18 17:04:34,012 [52] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-02-18 17:04:34,014 [52] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:04:34,014 [52] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo
2014-02-18 17:04:34,016 [52] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:04:34,016 [52] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo<'201307020016' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:04:34,019 [52] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:04:34,019 [52] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo>'201307020016' and ProjectCode='201306030001' order by BillNo
2014-02-18 17:04:34,023 [52] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:04:34,023 [52] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:04:35,410 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:35,411 [52] DEBUG Sys - select Text as value,Text as text from sys_code where CodeType='MeasureUnit'
2014-02-18 17:04:35,412 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:35,412 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:04:35,412 [52] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:04:35,413 [52] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='PayType'
2014-02-18 17:04:35,413 [52] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:04:35,414 [52] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:04:35,415 [52] DEBUG Servicesys_code - 获取字段
2014-02-18 17:04:35,415 [52] DEBUG Sys - select top 1 Code from sys_code where CodeType='SupplyType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:04:35,416 [52] DEBUG Servicesys_code - 获取字段
2014-02-18 17:04:35,416 [52] DEBUG Sys - select top 1 Code from sys_code where CodeType='PayType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:04:36,442 [59] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:04:36,442 [59] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'CG00303%' order by MerchantsCode
2014-02-18 17:04:36,865 [55] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:04:36,865 [55] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307020016' order by A.MaterialCode
2014-02-18 17:04:52,878 [48] DEBUG Mms - update mms_receive set [ApproveState] = 'passed', [ApproveRemark] = '', [ApprovePerson] = '开发-小刘', [ApproveDate] = '2014-02-18 17:04:52' where [BillNo] = '201307020016'
2014-02-18 17:04:52,895 [48] DEBUG Mms - 
select A.*,B.WarehouseCode,B.ProjectCode 
from mms_receiveDetail A 
left join mms_receive B on B.BillNo = A.BillNo 
where A.BillNo='201307020016'
2014-02-18 17:04:53,223 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010105'
2014-02-18 17:04:53,236 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '7.00', [UnitPrice] = '12.00', [Money] = '84.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010105'
2014-02-18 17:04:53,400 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010105'
2014-02-18 17:04:53,408 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '8.00', [CreatePerson] = '颜荣华', [CreateDate] = '2013-06-05 17:58:00', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010105'
2014-02-18 17:04:53,671 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010105'
2014-02-18 17:04:53,679 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','24','0101010105','201306030002','3.00','12.00','36.0000','7.00','12.00','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:04:53,682 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010205'
2014-02-18 17:04:53,683 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '14.00', [UnitPrice] = '6.8571428571428571428571428571', [Money] = '96.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-12 11:09:48', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010205'
2014-02-18 17:04:53,690 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010205'
2014-02-18 17:04:53,691 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '25.00', [CreatePerson] = '访客', [CreateDate] = '2013-07-12 11:09:48', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010205'
2014-02-18 17:04:53,697 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010205'
2014-02-18 17:04:53,699 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','25','0101010205','201306030002','11.00','8.00','88.0000','14.00','6.86','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:04:53,702 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010104'
2014-02-18 17:04:53,703 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '-38.00', [UnitPrice] = '12.289473684210526315789473684', [Money] = '-467.0000', [WarnStockDown] = '', [CreatePerson] = '刘会胜', [CreateDate] = '2013-07-13 22:22:08', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010104'
2014-02-18 17:04:53,710 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010104'
2014-02-18 17:04:53,711 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '-35.00', [CreatePerson] = '颜荣华', [CreateDate] = '2013-06-05 17:58:00', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010104'
2014-02-18 17:04:53,717 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010104'
2014-02-18 17:04:53,718 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','26','0101010104','201306030002','1.00','0.00','0.0000','-38.00','12.29','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:04:53,721 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010107'
2014-02-18 17:04:53,722 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '4.00', [UnitPrice] = '22.00', [Money] = '88.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010107'
2014-02-18 17:04:53,723 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010107'
2014-02-18 17:04:53,724 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '7.00', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010107'
2014-02-18 17:04:53,730 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010107'
2014-02-18 17:04:53,731 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','27','0101010107','201306030002','2.00','0.00','0.0000','4.00','22.00','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:04:53,734 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0507'
2014-02-18 17:04:53,737 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '笔', [Num] = '2.00', [UnitPrice] = '1.50', [Money] = '3.0000', [WarnStockDown] = '', [CreatePerson] = '管理员', [CreateDate] = '2013-12-09 20:30:52', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0507'
2014-02-18 17:04:53,744 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0507'
2014-02-18 17:04:53,747 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '3.00', [CreatePerson] = '刘会胜', [CreateDate] = '2013-09-11 15:53:02', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0507'
2014-02-18 17:04:53,753 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0507'
2014-02-18 17:04:53,756 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','28','0507','201306030002','1.00','0.00','0.0000','2.00','1.50','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:04:53,759 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010309'
2014-02-18 17:04:53,760 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '1.00', [UnitPrice] = '0.00', [Money] = '0.0000', [WarnStockDown] = '', [CreatePerson] = '管理员', [CreateDate] = '2013-12-09 20:30:52', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010309'
2014-02-18 17:04:53,767 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010309'
2014-02-18 17:04:53,768 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '2.00', [CreatePerson] = '刘会胜', [CreateDate] = '2013-09-11 15:53:02', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:04:53', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010309'
2014-02-18 17:04:53,769 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010309'
2014-02-18 17:04:53,771 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','30','0101010309','201306030002','1.00','0.00','0.0000','1.00','0.00','','','开发-小刘','2014-02-18 17:04:53','开发-小刘','2014-02-18 17:04:53')
2014-02-18 17:05:04,971 [48] DEBUG Mms - update mms_receive set [ApproveState] = 'reject', [ApproveRemark] = '', [ApprovePerson] = '开发-小刘', [ApproveDate] = '2014-02-18 17:05:04' where [BillNo] = '201307020016'
2014-02-18 17:05:04,972 [48] DEBUG Mms - 
select A.*,B.WarehouseCode,B.ProjectCode 
from mms_receiveDetail A 
left join mms_receive B on B.BillNo = A.BillNo 
where A.BillNo='201307020016'
2014-02-18 17:05:05,147 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010105'
2014-02-18 17:05:05,148 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '4.00', [UnitPrice] = '12.00', [Money] = '48.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010105'
2014-02-18 17:05:05,218 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010105'
2014-02-18 17:05:05,219 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '5.00', [CreatePerson] = '颜荣华', [CreateDate] = '2013-06-05 17:58:00', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010105'
2014-02-18 17:05:05,437 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010105'
2014-02-18 17:05:05,438 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','24','0101010105','201306030002','-3.00','12.00','-36.0000','4.00','12.00','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:05,439 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010205'
2014-02-18 17:05:05,441 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '3.00', [UnitPrice] = '2.6666666666666666666666666667', [Money] = '8.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-12 11:09:48', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010205'
2014-02-18 17:05:05,447 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010205'
2014-02-18 17:05:05,449 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '14.00', [CreatePerson] = '访客', [CreateDate] = '2013-07-12 11:09:48', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010205'
2014-02-18 17:05:05,450 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010205'
2014-02-18 17:05:05,451 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','25','0101010205','201306030002','-11.00','8.00','-88.0000','3.00','2.67','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:05,454 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010104'
2014-02-18 17:05:05,455 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '-39.00', [UnitPrice] = '11.974358974358974358974358974', [Money] = '-467.0000', [WarnStockDown] = '', [CreatePerson] = '刘会胜', [CreateDate] = '2013-07-13 22:22:08', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010104'
2014-02-18 17:05:05,456 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010104'
2014-02-18 17:05:05,457 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '-36.00', [CreatePerson] = '颜荣华', [CreateDate] = '2013-06-05 17:58:00', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010104'
2014-02-18 17:05:05,458 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010104'
2014-02-18 17:05:05,459 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','26','0101010104','201306030002','-1.00','0.00','0.0000','-39.00','11.97','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:05,460 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010107'
2014-02-18 17:05:05,461 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '2.00', [UnitPrice] = '44.00', [Money] = '88.0000', [WarnStockDown] = '', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010107'
2014-02-18 17:05:05,462 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010107'
2014-02-18 17:05:05,463 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '5.00', [CreatePerson] = '访客', [CreateDate] = '2013-07-02 8:02:05', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010107'
2014-02-18 17:05:05,464 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010107'
2014-02-18 17:05:05,465 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','27','0101010107','201306030002','-2.00','0.00','0.0000','2.00','44.00','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:05,475 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0507'
2014-02-18 17:05:05,476 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '笔', [Num] = '1.00', [UnitPrice] = '3.00', [Money] = '3.0000', [WarnStockDown] = '', [CreatePerson] = '管理员', [CreateDate] = '2013-12-09 20:30:52', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0507'
2014-02-18 17:05:05,477 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0507'
2014-02-18 17:05:05,478 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '2.00', [CreatePerson] = '刘会胜', [CreateDate] = '2013-09-11 15:53:02', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0507'
2014-02-18 17:05:05,479 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0507'
2014-02-18 17:05:05,480 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','28','0507','201306030002','-1.00','0.00','0.0000','1.00','3.00','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:05,481 [48] DEBUG Mms - select * from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010309'
2014-02-18 17:05:05,483 [48] DEBUG Mms - update mms_warehouseStock set [Unit] = '吨', [Num] = '0.00', [UnitPrice] = '0.0000', [Money] = '0.0000', [WarnStockDown] = '', [CreatePerson] = '管理员', [CreateDate] = '2013-12-09 20:30:52', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [WarehouseCode] = '201306030002' and [MaterialCode] = '0101010309'
2014-02-18 17:05:05,489 [48] DEBUG Mms - select * from mms_materialWarnning where ProjectCode='201306030001' and MaterialCode='0101010309'
2014-02-18 17:05:05,491 [48] DEBUG Mms - update mms_materialWarnning set [LowerNum] = '0.00', [UpperNum] = '0.00', [Num] = '1.00', [CreatePerson] = '刘会胜', [CreateDate] = '2013-09-11 15:53:02', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:05:05', [Remark] = '' where [ProjectCode] = '201306030001' and [MaterialCode] = '0101010309'
2014-02-18 17:05:05,492 [48] DEBUG Mms - select Num,UnitPrice from mms_warehouseStock where WarehouseCode='201306030002' and MaterialCode='0101010309'
2014-02-18 17:05:05,493 [48] DEBUG Mms - insert into mms_warehouseStockHistory([SrcBillType],[SrcBillNo],[SrcRowId],[MaterialCode],[WarehouseCode],[Num],[UnitPrice],[Money],[StockNum],[StockUnitPrice],[StockMoney],[Remark],[CreatePerson],[CreateDate],[UpdatePerson],[UpdateDate]) values('receive','201307020016','30','0101010309','201306030002','-1.00','0.00','0.0000','0.00','0.00','','','开发-小刘','2014-02-18 17:05:05','开发-小刘','2014-02-18 17:05:05')
2014-02-18 17:05:08,468 [49] DEBUG Servicemms_materialType - 获取动态列表
2014-02-18 17:05:08,469 [49] DEBUG Mms - select MaterialTypeName as text,MaterialType as id,ParentCode as pid from mms_materialType order by MaterialType
2014-02-18 17:05:08,540 [57] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:08,541 [57] DEBUG Mms - select top 10 A.* from mms_material A order by A.MaterialCode
2014-02-18 17:05:08,543 [57] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:10,795 [49] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:10,796 [49] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 11 and 20
2014-02-18 17:05:10,800 [49] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:11,216 [57] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:11,217 [57] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 21 and 30
2014-02-18 17:05:11,220 [57] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:11,636 [52] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:11,637 [52] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 31 and 40
2014-02-18 17:05:11,642 [52] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:14,396 [52] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:14,397 [52] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 41 and 50
2014-02-18 17:05:14,402 [52] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:14,820 [53] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:14,821 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 51 and 60
2014-02-18 17:05:14,825 [53] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:15,362 [53] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:15,363 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 61 and 70
2014-02-18 17:05:15,366 [53] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:16,848 [53] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:16,849 [53] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 71 and 80
2014-02-18 17:05:16,853 [53] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:18,193 [46] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:18,194 [46] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 81 and 90
2014-02-18 17:05:18,201 [46] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:18,852 [52] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:18,853 [52] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 91 and 100
2014-02-18 17:05:18,857 [52] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:20,867 [48] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:05:20,868 [48] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, row_number() over (order by A.MaterialCode) as FLUENTDATA_ROWNUMBER
									 from mms_material A
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 101 and 110
2014-02-18 17:05:20,872 [48] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:05:24,462 [48] DEBUG Servicemms_receiveDetail - 获取新主键
2014-02-18 17:05:24,465 [48] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1 and BillNo='201307020016'
2014-02-18 17:05:24,472 [48] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1 and BillNo='201307020016'
2014-02-18 17:05:24,473 [48] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1 and BillNo='201307020016'
2014-02-18 17:05:24,474 [48] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1 and BillNo='201307020016'
2014-02-18 17:06:11,545 [17] DEBUG Servicemms_receive - 获取实体对象
2014-02-18 17:06:11,546 [17] DEBUG Mms - select mms_receive.* from mms_receive where BillNo='201307020022'
2014-02-18 17:06:11,547 [17] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-02-18 17:06:11,547 [17] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:06:11,547 [17] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo
2014-02-18 17:06:11,548 [17] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:06:11,548 [17] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo<'201307020022' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:06:11,550 [17] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:06:11,551 [17] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo>'201307020022' and ProjectCode='201306030001' order by BillNo
2014-02-18 17:06:11,553 [17] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:06:11,553 [17] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:06:11,665 [60] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:06:11,666 [60] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307020022' order by A.MaterialCode
2014-02-18 17:06:11,724 [47] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:06:11,724 [47] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'CG00304%' order by MerchantsCode
2014-02-18 17:06:17,616 [17] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:06:25,311 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:06:25,316 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','homeTabTitle','','我的桌面','')
2014-02-18 17:06:25,397 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:06:25,402 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','homeTabUrl','','/home/welcome','')
2014-02-18 17:06:25,405 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:06:25,408 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','maxTabCount','','10','')
2014-02-18 17:06:25,411 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:06:25,414 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','navigation','','accordion','')
2014-02-18 17:06:25,418 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:06:25,422 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','gridrows','','20','')
2014-02-18 17:06:25,426 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:06:25,429 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','locale','','zh_CN','')
2014-02-18 17:06:25,432 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:06:25,435 [47] DEBUG Sys - insert into sys_userSetting([UserCode],[SettingCode],[SettingName],[SettingValue],[Description]) values('lhs','theme','','gray','')
2014-02-18 17:06:26,465 [59] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:06:26,465 [59] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 17:06:26,476 [59] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:06:26,663 [59] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:06:26,663 [59] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 17:06:26,930 [48] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 17:06:28,982 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:06:28,986 [57] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:06:28,987 [57] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:06:28,988 [57] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:06:28,988 [57] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:06:31,071 [50] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:06:31,071 [50] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:06:31,073 [50] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:10:19,418 [51] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:10:41,357 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:10:41,357 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:10:41,358 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:10:41,359 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = 'tree' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:10:41,363 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:10:41,363 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:10:41,364 [17] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:10:42,596 [49] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:10:42,597 [49] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 17:10:42,610 [49] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:10:42,612 [49] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:10:42,612 [49] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 17:10:43,165 [51] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 17:10:48,799 [47] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:10:51,792 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:10:51,793 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:10:51,793 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:10:51,794 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = 'menubutton' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:10:51,798 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:10:51,798 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:10:51,799 [37] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:10:52,742 [45] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:10:52,742 [45] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 17:10:52,757 [45] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:10:52,833 [45] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:10:52,833 [45] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 17:10:53,848 [34] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 17:10:59,228 [47] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:11:09,425 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:11:09,426 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:11:09,426 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:11:09,427 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:11:09,507 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:11:09,507 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:11:09,508 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:11:11,960 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:11:11,961 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:11:11,962 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:11:11,963 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:11:11,963 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:11:11,965 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:11:11,965 [47] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:11:13,144 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:11:13,145 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:11:13,145 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:11:13,146 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:11:13,146 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:11:13,147 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:11:13,147 [51] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:11:16,544 [47] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:11:16,545 [47] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 17:11:16,562 [47] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:11:16,564 [47] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:11:16,564 [47] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 17:11:16,749 [17] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 17:11:18,391 [17] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:11:18,394 [17] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:11:18,399 [17] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:11:18,400 [17] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:11:18,400 [17] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:11:18,998 [55] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:11:18,999 [55] DEBUG Mms - select top 10 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:11:19,009 [55] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:11:22,405 [17] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:11:22,406 [17] DEBUG Mms - with PagedPersons as
								(
									select top 100 percent A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName, row_number() over (order by A.BillNo) as FLUENTDATA_ROWNUMBER
									 from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001'
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 11 and 20
2014-02-18 17:11:22,421 [17] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:11:24,441 [47] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:11:27,124 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:11:27,125 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:11:27,126 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:11:27,127 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:11:27,127 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:11:27,206 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:11:27,207 [54] DEBUG Sys - update sys_userSetting set [SettingValue] = 'gray' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:11:39,976 [47] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-02-18 17:11:39,992 [47] DEBUG Servicesys_user - 获取动态列表
2014-02-18 17:11:39,993 [47] DEBUG Sys - select UserCode,UserName from sys_user
2014-02-18 17:11:39,993 [47] DEBUG Servicesys_organize - 获取动态列表
2014-02-18 17:11:39,993 [47] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-02-18 17:11:40,253 [34] DEBUG Servicesys_role - 获取实体列表
2014-02-18 17:11:40,253 [34] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-02-18 17:11:42,794 [34] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'super')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'super')
2014-02-18 17:11:51,653 [51] DEBUG Sys - 
 select A1.UserName as MemberName ,A1.UserCode as MemberCode,'user' as MemberType
  from sys_user A1
 where A1.UserCode in (select B1.UserCode from sys_userRoleMap B1 where B1.RoleCode = 'super')
union
 select A2.OrganizeName as MemberName ,A2.OrganizeCode as MemberCode,'organize' as MemberType
   from sys_organize A2
  where A2.OrganizeCode in (select B2.OrganizeCode from sys_organizeRoleMap B2 where B2.RoleCode = 'super')
2014-02-18 17:12:01,908 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-02-18 17:12:02,935 [32] DEBUG Servicesys_user - 获取实体列表
2014-02-18 17:12:02,935 [32] DEBUG Sys - select top 10 sys_user.* from sys_user order by UserSeq
2014-02-18 17:12:03,010 [49] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 17:12:03,010 [49] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 17:12:03,028 [32] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-02-18 17:12:11,952 [57] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'lhs'
2014-02-18 17:12:17,862 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-02-18 17:12:18,710 [17] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 17:12:18,710 [17] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 17:12:18,746 [49] DEBUG Servicesys_user - 获取实体列表
2014-02-18 17:12:18,746 [49] DEBUG Sys - select top 10 sys_user.* from sys_user order by UserSeq
2014-02-18 17:12:18,748 [49] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-02-18 17:12:20,191 [49] DEBUG Sys - 
select distinct A.OrganizeCode,A.OrganizeName,A.ParentCode
,(case when B.UserCode is null then 'false' else 'true' end) as Checked
from sys_organize A
left join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode and B.UserCode = 'lhs'
2014-02-18 17:12:24,998 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/user/Index','/Sys/user')
2014-02-18 17:12:25,301 [48] DEBUG Servicesys_organize - 获取实体列表
2014-02-18 17:12:25,301 [48] DEBUG Sys - select sys_organize.* from sys_organize
2014-02-18 17:12:25,338 [53] DEBUG Servicesys_user - 获取实体列表
2014-02-18 17:12:25,339 [53] DEBUG Sys - select top 10 sys_user.* from sys_user order by UserSeq
2014-02-18 17:12:25,340 [53] DEBUG Sys - select count(*) from ( select sys_user.* from sys_user ) tb_temp
2014-02-18 17:12:26,696 [37] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'scy'
2014-02-18 17:12:33,725 [57] DEBUG Sys - 
select distinct A.RoleCode,A.RoleName
,(case when B.RoleCode is null then 'false' else 'true' end) as Checked
from sys_role A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode and B.UserCode = 'scy'
2014-02-18 17:12:42,827 [53] DEBUG Servicesys_userSetting - 获取实体列表
2014-02-18 17:12:42,828 [53] DEBUG Sys - select sys_userSetting.* from sys_userSetting where UserCode='scy'
2014-02-18 17:12:57,268 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-02-18 17:12:58,542 [54] DEBUG Servicesys_codeType - 获取动态列表
2014-02-18 17:12:58,543 [54] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-02-18 17:12:58,689 [45] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:12:58,690 [45] DEBUG Sys - select top 10 sys_code.* from sys_code order by Seq
2014-02-18 17:12:58,751 [45] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-02-18 17:13:04,223 [37] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:04,224 [37] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='Education' order by Seq
2014-02-18 17:13:04,227 [37] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='Education' ) tb_temp
2014-02-18 17:13:06,044 [45] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:06,045 [45] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='PartAttr' order by Seq
2014-02-18 17:13:06,048 [45] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='PartAttr' ) tb_temp
2014-02-18 17:13:09,312 [37] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:09,312 [37] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='Sex' order by Seq
2014-02-18 17:13:09,315 [37] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='Sex' ) tb_temp
2014-02-18 17:13:10,618 [47] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:10,619 [47] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='PersonType' order by Seq
2014-02-18 17:13:10,622 [47] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='PersonType' ) tb_temp
2014-02-18 17:13:12,386 [47] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:12,387 [47] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='Education' order by Seq
2014-02-18 17:13:12,388 [47] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='Education' ) tb_temp
2014-02-18 17:13:14,080 [47] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:14,080 [47] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='area' order by Seq
2014-02-18 17:13:14,084 [47] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='area' ) tb_temp
2014-02-18 17:13:14,783 [48] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:13:14,783 [48] DEBUG Sys - select top 10 sys_code.* from sys_code where CodeType='QualificationLevel' order by Seq
2014-02-18 17:13:14,787 [48] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code where CodeType='QualificationLevel' ) tb_temp
2014-02-18 17:13:18,751 [37] DEBUG Servicesys_codeType - 获取动态列表
2014-02-18 17:13:18,751 [37] DEBUG Sys - select top 10 sys_codeType.* from sys_codeType order by Seq,CodeType
2014-02-18 17:13:18,753 [37] DEBUG Sys - select count(*) from ( select sys_codeType.* from sys_codeType ) tb_temp
2014-02-18 17:13:20,066 [37] DEBUG Servicesys_codeType - 获取动态列表
2014-02-18 17:13:20,067 [37] DEBUG Sys - with PagedPersons as
								(
									select top 100 percent sys_codeType.*, row_number() over (order by Seq,CodeType) as FLUENTDATA_ROWNUMBER
									 from sys_codeType
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 11 and 20
2014-02-18 17:13:20,070 [37] DEBUG Sys - select count(*) from ( select sys_codeType.* from sys_codeType ) tb_temp
2014-02-18 17:13:20,544 [45] DEBUG Servicesys_codeType - 获取动态列表
2014-02-18 17:13:20,544 [45] DEBUG Sys - with PagedPersons as
								(
									select top 100 percent sys_codeType.*, row_number() over (order by Seq,CodeType) as FLUENTDATA_ROWNUMBER
									 from sys_codeType
								)
								select *
								from PagedPersons
								where fluentdata_RowNumber between 21 and 30
2014-02-18 17:13:20,548 [45] DEBUG Sys - select count(*) from ( select sys_codeType.* from sys_codeType ) tb_temp
2014-02-18 17:13:28,100 [47] DEBUG Servicesys_code - 编辑记录
2014-02-18 17:13:28,101 [47] DEBUG Sys - select sys_code.* from sys_code where Code='021'
2014-02-18 17:13:28,104 [47] DEBUG Sys - update sys_code set [CodeType] = 'QualificationLevel', [Value] = 'UnderThree', [Text] = '三级及以下', [ParentCode] = '0', [Description] = '11', [IsEnable] = 'True', [IsDefault] = '0', [Seq] = '4', [UpdatePerson] = '开发-小刘', [UpdateDate] = '2014-02-18 17:13:28' where [Code] = '021'
2014-02-18 17:13:40,869 [37] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-02-18 17:13:41,432 [55] DEBUG Servicesys_parameter - 获取实体列表
2014-02-18 17:13:41,433 [55] DEBUG Sys - select top 10 sys_parameter.* from sys_parameter order by ParamCode
2014-02-18 17:13:41,496 [55] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-02-18 17:13:53,240 [45] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/parameter/Index','/Sys/parameter')
2014-02-18 17:13:53,506 [48] DEBUG Servicesys_parameter - 获取实体列表
2014-02-18 17:13:53,506 [48] DEBUG Sys - select top 10 sys_parameter.* from sys_parameter order by ParamCode
2014-02-18 17:13:53,507 [48] DEBUG Sys - select count(*) from ( select sys_parameter.* from sys_parameter ) tb_temp
2014-02-18 17:13:55,841 [37] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-02-18 17:13:56,500 [54] DEBUG Servicesys_log - 获取实体列表
2014-02-18 17:13:56,500 [48] DEBUG Servicesys_loginHistory - 获取实体列表
2014-02-18 17:13:56,502 [54] DEBUG Sys - select top 10 A.* from sys_log A order by A.ID desc
2014-02-18 17:13:56,502 [48] DEBUG Sys - select top 10 A.* from sys_loginHistory A order by A.ID desc
2014-02-18 17:13:56,667 [48] DEBUG Sys - select count(*) from ( select A.* from sys_loginHistory A ) tb_temp
2014-02-18 17:13:56,769 [54] DEBUG Sys - select count(*) from ( select A.* from sys_log A ) tb_temp
2014-02-18 17:15:05,969 [17] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:15:05,971 [17] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:15:05,972 [17] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:15:05,973 [17] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:15:05,973 [17] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:15:06,665 [59] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:15:06,666 [59] DEBUG Mms - select top 10 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:15:06,667 [59] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:15:17,250 [32] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/role/Index','/Sys/role')
2014-02-18 17:15:17,251 [32] DEBUG Servicesys_user - 获取动态列表
2014-02-18 17:15:17,252 [32] DEBUG Sys - select UserCode,UserName from sys_user
2014-02-18 17:15:17,252 [32] DEBUG Servicesys_organize - 获取动态列表
2014-02-18 17:15:17,252 [32] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2014-02-18 17:15:17,550 [59] DEBUG Servicesys_role - 获取实体列表
2014-02-18 17:15:17,550 [59] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2014-02-18 17:15:19,239 [53] DEBUG Sys - select * from sys_button order by ButtonSeq
2014-02-18 17:15:19,257 [53] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' ,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2014-02-18 17:15:19,287 [53] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2014-02-18 17:15:19,322 [32] DEBUG Servicesys_permission - 获取动态列表
2014-02-18 17:15:19,322 [32] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2014-02-18 17:16:30,719 [45] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/log/Index','/Sys/log')
2014-02-18 17:16:31,227 [54] DEBUG Servicesys_loginHistory - 获取实体列表
2014-02-18 17:16:31,227 [54] DEBUG Sys - select top 10 A.* from sys_loginHistory A order by A.ID desc
2014-02-18 17:16:31,228 [54] DEBUG Sys - select count(*) from ( select A.* from sys_loginHistory A ) tb_temp
2014-02-18 17:16:31,240 [37] DEBUG Servicesys_log - 获取实体列表
2014-02-18 17:16:31,241 [37] DEBUG Sys - select top 10 A.* from sys_log A order by A.ID desc
2014-02-18 17:16:31,241 [37] DEBUG Sys - select count(*) from ( select A.* from sys_log A ) tb_temp
2014-02-18 17:18:32,983 [49] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:18:32,986 [49] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:18:32,986 [49] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:18:32,987 [49] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:18:32,987 [49] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:18:33,521 [45] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:18:33,521 [45] DEBUG Mms - select top 10 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:18:33,523 [45] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:19:12,933 [57] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/edit')
2014-02-18 17:19:12,936 [57] DEBUG Servicemms_receive - 获取实体对象
2014-02-18 17:19:12,936 [57] DEBUG Mms - select mms_receive.* from mms_receive where BillNo='201307020014'
2014-02-18 17:19:12,937 [57] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-02-18 17:19:12,937 [57] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:19:12,938 [57] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo
2014-02-18 17:19:12,938 [57] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:19:12,938 [57] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo<'201307020014' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:19:12,940 [57] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:19:12,941 [57] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo>'201307020014' and ProjectCode='201306030001' order by BillNo
2014-02-18 17:19:12,942 [57] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:19:12,943 [57] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:19:12,943 [57] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:19:12,944 [57] DEBUG Sys - select Text as value,Text as text from sys_code where CodeType='MeasureUnit'
2014-02-18 17:19:12,944 [57] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:19:12,944 [57] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:19:12,945 [57] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:19:12,945 [57] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='PayType'
2014-02-18 17:19:12,946 [57] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:19:12,946 [57] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:19:12,947 [57] DEBUG Servicesys_code - 获取字段
2014-02-18 17:19:12,947 [57] DEBUG Sys - select top 1 Code from sys_code where CodeType='SupplyType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:19:12,947 [57] DEBUG Servicesys_code - 获取字段
2014-02-18 17:19:12,948 [57] DEBUG Sys - select top 1 Code from sys_code where CodeType='PayType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:19:13,861 [37] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:19:13,861 [37] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'CG00303%' order by MerchantsCode
2014-02-18 17:19:14,108 [57] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:19:14,108 [57] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307020014' order by A.MaterialCode
2014-02-18 17:20:17,092 [48] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:20:19,970 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = '我的桌面' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabTitle'
2014-02-18 17:20:19,971 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = '/home/welcome' where [UserCode] = 'lhs' and [SettingCode] = 'homeTabUrl'
2014-02-18 17:20:19,972 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = '10' where [UserCode] = 'lhs' and [SettingCode] = 'maxTabCount'
2014-02-18 17:20:19,972 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = 'accordion' where [UserCode] = 'lhs' and [SettingCode] = 'navigation'
2014-02-18 17:20:19,973 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = '20' where [UserCode] = 'lhs' and [SettingCode] = 'gridrows'
2014-02-18 17:20:19,974 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = 'zh_CN' where [UserCode] = 'lhs' and [SettingCode] = 'locale'
2014-02-18 17:20:19,975 [48] DEBUG Sys - update sys_userSetting set [SettingValue] = 'default' where [UserCode] = 'lhs' and [SettingCode] = 'theme'
2014-02-18 17:20:21,166 [39] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:20:21,166 [39] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_NAME'
2014-02-18 17:20:21,179 [39] DEBUG Sys - select * from sys_userSetting where UserCode='lhs'
2014-02-18 17:20:21,181 [39] DEBUG Servicesys_parameter - 获取字段
2014-02-18 17:20:21,182 [39] DEBUG Sys - select ParamValue from sys_parameter where ParamCode='SYS_COPYRIGHT'
2014-02-18 17:20:21,503 [60] DEBUG Sys - 
-- 角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'lhs' -- 用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  -- 机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'lhs'
  )  
)
order by B.MenuSeq,B.MenuCode
2014-02-18 17:20:29,915 [50] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2014-02-18 17:20:30,226 [46] DEBUG Servicesys_menu - 获取动态列表
2014-02-18 17:20:30,227 [46] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2014-02-18 17:26:05,683 [17] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:26:05,686 [17] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:26:05,691 [17] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:26:05,691 [17] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:26:05,692 [17] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:26:06,562 [39] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:26:06,562 [39] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:26:06,564 [39] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:26:11,091 [47] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2014-02-18 17:26:11,094 [47] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:26:11,094 [47] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:26:11,095 [47] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:26:11,095 [47] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:26:12,407 [17] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:26:12,408 [17] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:26:12,411 [17] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:30:24,846 [17] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:30:24,848 [17] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.WarehouseCode='201306030001'  and datediff(day,'2014-01-01 ',ReceiveDate) >=0 and datediff(day,' 2014-01-31',ReceiveDate) <=0  and A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:30:24,880 [17] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.WarehouseCode='201306030001'  and datediff(day,'2014-01-01 ',ReceiveDate) >=0 and datediff(day,' 2014-01-31',ReceiveDate) <=0  and A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:30:25,903 [53] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:30:25,903 [53] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:30:25,906 [53] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:37:31,339 [57] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:37:31,345 [57] DEBUG Mms - select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:37:49,637 [17] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:37:49,637 [17] DEBUG Mms - select top 20 A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' order by A.BillNo
2014-02-18 17:37:49,639 [17] DEBUG Mms - select count(*) from ( select A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName from mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType     = A.MaterialType
        left join mms_warehouse     D on D.WarehouseCode    = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode where A.ProjectCode='201306030001' ) tb_temp
2014-02-18 17:38:58,253 [39] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/balanceaccount')
2014-02-18 17:38:58,275 [39] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:38:58,276 [39] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:38:58,278 [39] DEBUG Servicemms_buildPart - 获取动态列表
2014-02-18 17:38:58,279 [39] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where ProjectCode='201306030001'
2014-02-18 17:38:59,398 [60] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-02-18 17:38:59,539 [60] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Num else 0 end),0) as PickUnitNum2 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Money else 0 end),0) as PickUnitMoney2                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-02-18 17:38:59,715 [60] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-02-18 17:39:18,306 [32] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/receive/edit')
2014-02-18 17:39:18,308 [32] DEBUG Servicemms_receive - 获取实体对象
2014-02-18 17:39:18,309 [32] DEBUG Mms - select mms_receive.* from mms_receive where BillNo='201307020002'
2014-02-18 17:39:18,310 [32] DEBUG Servicemms_receive - 获取上一条下一条数据
2014-02-18 17:39:18,310 [32] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:39:18,310 [32] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo
2014-02-18 17:39:18,310 [32] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:39:18,311 [32] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo<'201307020002' and ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:39:18,311 [32] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:39:18,312 [32] DEBUG Mms - select top 1 BillNo from mms_receive where BillNo>'201307020002' and ProjectCode='201306030001' order by BillNo
2014-02-18 17:39:18,312 [32] DEBUG Servicemms_receive - 获取字段
2014-02-18 17:39:18,312 [32] DEBUG Mms - select top 1 BillNo from mms_receive where ProjectCode='201306030001' order by BillNo desc
2014-02-18 17:39:18,313 [32] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:39:18,313 [32] DEBUG Sys - select Text as value,Text as text from sys_code where CodeType='MeasureUnit'
2014-02-18 17:39:18,314 [32] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:39:18,314 [32] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='SupplyType'
2014-02-18 17:39:18,315 [32] DEBUG Servicesys_code - 获取动态列表
2014-02-18 17:39:18,315 [32] DEBUG Sys - select Code as value,Text as text from sys_code where CodeType='PayType'
2014-02-18 17:39:18,315 [32] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:39:18,316 [32] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:39:18,316 [32] DEBUG Servicesys_code - 获取字段
2014-02-18 17:39:18,317 [32] DEBUG Sys - select top 1 Code from sys_code where CodeType='SupplyType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:39:18,317 [32] DEBUG Servicesys_code - 获取字段
2014-02-18 17:39:18,317 [32] DEBUG Sys - select top 1 Code from sys_code where CodeType='PayType' and IsEnable='1' and IsDefault='1'
2014-02-18 17:39:19,139 [39] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:39:19,139 [39] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'CG00303%' order by MerchantsCode
2014-02-18 17:39:19,563 [50] DEBUG Servicemms_receive - 获取动态列表
2014-02-18 17:39:19,563 [50] DEBUG Mms - select A.*, B.MaterialName,B.Model,B.Material from mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode where BillNo='201307020002' order by A.MaterialCode
2014-02-18 17:45:54,955 [52] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:45:54,961 [52] DEBUG Mms - select top 20 MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') order by MerchantsCode
2014-02-18 17:45:54,968 [52] DEBUG Mms - select count(*) from ( select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') ) tb_temp
2014-02-18 17:46:08,989 [47] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:46:08,989 [47] DEBUG Mms - select top 20 MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') order by MerchantsCode
2014-02-18 17:46:08,991 [47] DEBUG Mms - select count(*) from ( select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') ) tb_temp
2014-02-18 17:46:20,667 [44] DEBUG Servicemms_materialType - 获取动态列表
2014-02-18 17:46:20,667 [44] DEBUG Mms - select MaterialTypeName as text,MaterialType as id,ParentCode as pid from mms_materialType order by MaterialType
2014-02-18 17:46:20,735 [34] DEBUG Servicemms_material - 获取动态列表
2014-02-18 17:46:20,735 [34] DEBUG Mms - select top 10 A.* from mms_material A order by A.MaterialCode
2014-02-18 17:46:20,736 [34] DEBUG Mms - select count(*) from ( select A.* from mms_material A ) tb_temp
2014-02-18 17:46:24,639 [46] DEBUG Servicemms_receiveDetail - 获取新主键
2014-02-18 17:46:24,639 [46] DEBUG Mms - select isnull(max(RowId),0) from mms_receiveDetail  where 1 = 1 and BillNo='201307020002'
2014-02-18 17:52:18,322 [53] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Sys/code/Index','/Sys/code')
2014-02-18 17:52:18,728 [46] DEBUG Servicesys_codeType - 获取动态列表
2014-02-18 17:52:18,729 [46] DEBUG Sys - select sys_codeType.* from sys_codeType order by Seq,CodeType
2014-02-18 17:52:18,856 [60] DEBUG Servicesys_code - 获取实体列表
2014-02-18 17:52:18,857 [60] DEBUG Sys - select top 20 sys_code.* from sys_code order by Seq
2014-02-18 17:52:18,860 [60] DEBUG Sys - select count(*) from ( select sys_code.* from sys_code ) tb_temp
2014-02-18 17:52:21,997 [32] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/material/Index','/Mms/material')
2014-02-18 17:52:22,873 [52] DEBUG Servicemms_materialType - 获取动态列表
2014-02-18 17:52:22,878 [52] DEBUG Mms - select mms_materialType.* from mms_materialType order by MaterialType
2014-02-18 17:52:22,918 [59] DEBUG Servicemms_material - 获取实体列表
2014-02-18 17:52:22,919 [59] DEBUG Mms - select top 20 mms_material.* from mms_material order by MaterialCode
2014-02-18 17:52:22,929 [59] DEBUG Mms - select count(*) from ( select mms_material.* from mms_material ) tb_temp
2014-02-18 17:53:07,947 [57] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:53:07,947 [57] DEBUG Mms - select top 20 MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') order by MerchantsCode
2014-02-18 17:53:07,949 [57] DEBUG Mms - select count(*) from ( select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') ) tb_temp
2014-02-18 17:53:09,501 [34] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:53:09,501 [34] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'CG00305%' order by MerchantsCode
2014-02-18 17:53:11,046 [49] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:53:11,047 [49] DEBUG Mms - select top 20 MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') order by MerchantsCode
2014-02-18 17:53:11,050 [49] DEBUG Mms - select count(*) from ( select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where B.MerchantsProperty in ('采购') ) tb_temp
2014-02-18 17:53:12,296 [39] DEBUG ServiceModelBase - 获取动态列表
2014-02-18 17:53:12,296 [39] DEBUG Mms - select MerchantsCode as value,MerchantsName as text from mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode where MerchantsCode like 'GY100003%' order by MerchantsCode
2014-02-18 17:53:44,461 [49] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/balanceaccount')
2014-02-18 17:53:44,464 [49] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:53:44,465 [49] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:53:44,465 [49] DEBUG Servicemms_buildPart - 获取动态列表
2014-02-18 17:53:44,465 [49] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where ProjectCode='201306030001'
2014-02-18 17:53:44,700 [49] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-02-18 17:53:44,744 [49] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Num else 0 end),0) as PickUnitNum2 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Money else 0 end),0) as PickUnitMoney2                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-02-18 17:53:44,749 [49] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

2014-02-18 17:58:01,022 [50] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/warehouseaccount')
2014-02-18 17:58:01,684 [53] DEBUG Mms - 
Select mms_warehouseStockHistory.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStockHistory.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where  mms_warehouse.ProjectCode='201306030001' 
order by mms_warehouseStockHistory.CreateDate desc
                
2014-02-18 17:58:18,510 [44] DEBUG Mms - 
Select mms_warehouseStockHistory.*,mms_material.MaterialName,mms_material.Model,mms_material.Unit
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.WarehouseCode=mms_warehouseStockHistory.WarehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where  mms_warehouse.ProjectCode='201306030001' 
order by mms_warehouseStockHistory.CreateDate desc
                
2014-02-18 17:59:43,743 [52] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'lhs'
and C.URL in ('/Mms/report/balanceaccount')
2014-02-18 17:59:43,745 [52] DEBUG Servicemms_warehouse - 获取动态列表
2014-02-18 17:59:43,745 [52] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where ProjectCode='201306030001'
2014-02-18 17:59:43,746 [52] DEBUG Servicemms_buildPart - 获取动态列表
2014-02-18 17:59:43,746 [52] DEBUG Mms - select BuildPartCode as value,BuildPartName as text from mms_buildPart where ProjectCode='201306030001'
2014-02-18 17:59:44,131 [39] DEBUG Mms - 
Select PickUnitName
From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
Where PickUnitName<>'' and PickUnitName<>'其他' and PickUnitName<>'租赁进场'
group by PickUnitName
                
2014-02-18 17:59:44,184 [39] DEBUG Mms - 
Select MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else 0 end),0) as ReceiveMoney --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Money else 0 end),0) as StockSelfMoney --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Money else 0 end),0) as OwnerSupplyMoney --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Money else 0 end),0) as CallInMoney --调入
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Money else 0 end),0) as ReceiveOtherMoney --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else 0 end),0) as ReceiveNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType='082' then Num else 0 end),0) as StockSelfNum --自采
    ,ISNULL(Sum(CASE WHEN SupplyType='083' then Num else 0 end),0) as OwnerSupplyNum --甲供
    ,ISNULL(Sum(CASE WHEN SupplyType='084' then Num else 0 end),0) as CallInNum --调入
	,ISNULL(Sum(CASE WHEN SupplyType='租赁进场' then Num else 0 end),0) as ReceiveRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN SupplyType='其他' then Num else 0 end),0) as ReceiveOtherNum --其他

    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Money else 0 end),0) as SendMoney --合计
    ,ISNULL(Sum(CASE WHEN PickUnitName<>'' then Num else 0 end),0) as SendNum --合计
     ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Num else 0 end),0) as PickUnitNum0 ,ISNULL(Sum(CASE WHEN PickUnitName='北京士兴钢结构有限公司' then Money else 0 end),0) as PickUnitMoney0 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Num else 0 end),0) as PickUnitNum1 ,ISNULL(Sum(CASE WHEN PickUnitName='河北天强建筑工程有限公司' then Money else 0 end),0) as PickUnitMoney1 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Num else 0 end),0) as PickUnitNum2 ,ISNULL(Sum(CASE WHEN PickUnitName='江苏华能建设工程集团有限公司asdfsadfsadf' then Money else 0 end),0) as PickUnitMoney2                                                             --领料人生成的列
    ,ISNULL(Sum(CASE WHEN PickUnitName='租赁进场' then Num else 0 end),0) as SendRentInNum --租赁进场
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Money else 0 end),0) as SendOtherMoney --其他
    ,ISNULL(Sum(CASE WHEN PickUnitName='其他' then Num else 0 end),0) as SendOtherNum --其他

    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Num else -Num end),0) as TotalNum --合计
    ,ISNULL(Sum(CASE WHEN SupplyType<>'' then Money else -Money end),0) as TotalMoney --合计

From (
--收料单
Select mms_receiveDetail.BillNo As SrcBillNo,mms_receiveDetail.RowId As SrcRowId,'receive' As SrcBillType,mms_receive.ReceiveDate As TakeDate,
	mms_receive.SupplyType As SupplyType,'' As PickUnitName, mms_receiveDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_receiveDetail.Unit,
	mms_receiveDetail.UnitPrice,mms_receiveDetail.Num,mms_receiveDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_receive
Left join mms_receiveDetail On mms_receiveDetail.BillNo=mms_receive.BillNo
Left join mms_material On mms_material.MaterialCode=mms_receiveDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_receive.ApproveState='passed'  And  mms_receive.ProjectCode='201306030001'

Union
--退货单
Select mms_returnDetail.BillNo As SrcBillNo,mms_returnDetail.RowId As SrcRowId,'return' As SrcBillType,mms_return.ReturnDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_returnDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_returnDetail.Unit,
	mms_returnDetail.UnitPrice,-mms_returnDetail.Num,-mms_returnDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_return
Left join mms_returnDetail On mms_returnDetail.BillNo=mms_return.BillNo
Left join mms_material On mms_material.MaterialCode=mms_returnDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_return.ApproveState='passed'  And  mms_return.ProjectCode='201306030001'

Union
--直入直出
Select mms_directDetail.BillNo As SrcBillNo,mms_directDetail.RowId As SrcRowId,'direct' As SrcBillType,mms_direct.ArriveDate As TakeDate,
	mms_direct.SupplyType As SupplyType,mms_merchants.MerchantsName As PickUnitName, mms_directDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_directDetail.Unit,
	mms_directDetail.UnitPrice,mms_directDetail.Num,mms_directDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_direct
Left join mms_directDetail On mms_directDetail.BillNo=mms_direct.BillNo
Left join mms_material On mms_material.MaterialCode=mms_directDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_direct.PickUnit
Where mms_direct.ApproveState='passed'  And  mms_direct.ProjectCode='201306030001'

Union
--租赁进场
Select mms_rentinDetail.BillNo As SrcBillNo,mms_rentinDetail.RowId As SrcRowId,'rentin' As SrcBillType,mms_rentin.RentInDate As TakeDate,
	'租赁进场' As SupplyType,'租赁进场' As PickUnitName, mms_rentinDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_rentinDetail.Unit,
	mms_rentinDetail.UnitPrice,mms_rentinDetail.Num,'0' As Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_rentin
Left join mms_rentinDetail On mms_rentinDetail.BillNo=mms_rentin.BillNo
Left join mms_material On mms_material.MaterialCode=mms_rentinDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_rentinDetail.UseUnit
Where mms_rentin.ApproveState='passed'  And  mms_rentin.ProjectCode='201306030001'

Union
--库存调整
Select mms_stockAdjustDetail.BillNo As SrcBillNo,mms_stockAdjustDetail.RowId As SrcRowId,'adjust' As SrcBillType,mms_stockAdjust.EffectDate As TakeDate,
	'其他' As SupplyType,'' As PickUnitName, mms_stockAdjustDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_stockAdjustDetail.Unit,
	mms_stockAdjustDetail.UnitPrice,mms_stockAdjustDetail.Num,mms_stockAdjustDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_stockAdjust
Left join mms_stockAdjustDetail On mms_stockAdjustDetail.BillNo=mms_stockAdjust.BillNo
Left join mms_material On mms_material.MaterialCode=mms_stockAdjustDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_stockAdjust.ApproveState='passed'  And  mms_stockAdjust.ProjectCode='201306030001'

Union
--发料
Select mms_sendDetail.BillNo As SrcBillNo,mms_sendDetail.RowId As SrcRowId,'send' As SrcBillType,mms_send.SendDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_sendDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_sendDetail.Unit,
	mms_sendDetail.UnitPrice,mms_sendDetail.Num,mms_sendDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_send
Left join mms_sendDetail On mms_sendDetail.BillNo=mms_send.BillNo
Left join mms_material On mms_material.MaterialCode=mms_sendDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_send.PickUnit
Where mms_send.ApproveState='passed'  And  mms_send.ProjectCode='201306030001'

Union
--退库
Select mms_refundDetail.BillNo As SrcBillNo,mms_refundDetail.RowId As SrcRowId,'refund' As SrcBillType,mms_refund.RefundDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_refundDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_refundDetail.Unit,
	mms_refundDetail.UnitPrice,-mms_refundDetail.Num,-mms_refundDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_refund
Left join mms_refundDetail On mms_refundDetail.BillNo=mms_refund.BillNo
Left join mms_material On mms_material.MaterialCode=mms_refundDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_refund.RefundUnit
Where mms_refund.ApproveState='passed'  And  mms_refund.ProjectCode='201306030001'

Union
--调拨
Select mms_transferDetail.BillNo As SrcBillNo,mms_transferDetail.RowId As SrcRowId,'transfer' As SrcBillType,mms_transfer.TransferDate As TakeDate,
	'' As SupplyType, mms_merchants.MerchantsName As PickUnitName,mms_transferDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_transferDetail.Unit,
	mms_transferDetail.UnitPrice,mms_transferDetail.Num,mms_transferDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_transfer
Left join mms_transferDetail On mms_transferDetail.BillNo=mms_transfer.BillNo
Left join mms_material On mms_material.MaterialCode=mms_transferDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Left join mms_merchants On mms_merchants.MerchantsCode=mms_transfer.ReceiveUnit
Where mms_transfer.ApproveState='passed' And  mms_transfer.ProjectCode='201306030001'

Union
--报损
Select mms_lossReportDetail.BillNo As SrcBillNo,mms_lossReportDetail.RowId As SrcRowId,'lossReport' As SrcBillType,mms_lossReport.LossReportDate As TakeDate,
	'' As SupplyType, '其他' As PickUnitName,mms_lossReportDetail.MaterialCode,mms_material.MaterialName,mms_material.Model,mms_lossReportDetail.Unit,
	mms_lossReportDetail.UnitPrice,mms_lossReportDetail.Num,mms_lossReportDetail.Money,mms_material.MaterialType,mms_materialType.Type As MaterialKind
From mms_lossReport
Left join mms_lossReportDetail On mms_lossReportDetail.BillNo=mms_lossReport.BillNo
Left join mms_material On mms_material.MaterialCode=mms_lossReportDetail.MaterialCode
Left join mms_materialType On mms_materialType.MaterialType=mms_material.MaterialType
Where mms_lossReport.ApproveState='passed'  And  mms_lossReport.ProjectCode='201306030001'
) as t
group by MaterialCode,MaterialName,Model,MaterialKind,MaterialType,Unit

2014-02-18 17:59:44,189 [39] DEBUG Mms - 
Select mms_warehouseStockHistory.MaterialCode,sum(Num) As InitNum,sum(UnitPrice*Num) As InitMoney
From mms_warehouseStockHistory
Left join mms_warehouse on mms_warehouse.warehouseCode=mms_warehouseStockHistory.warehouseCode
Left join mms_material on mms_material.MaterialCode=mms_warehouseStockHistory.MaterialCode
Where 1=1  And  mms_warehouse.ProjectCode='201306030001'
group by mms_warehouseStockHistory.MaterialCode

